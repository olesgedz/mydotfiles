"use strict";var Dropdown=function(){function t(t,e){var i=this;this.options=[];this.selectedOption=0;this.dropdownVisible=false;this.changeCallback=e;this.elem=document.getElementById(t);this.currentValueElem=document.createElement("div");this.currentValueElem.className="dropdownCurrentValue";this.dropdownOptionsElem=document.createElement("div");this.dropdownOptionsElem.className="dropdownOptions";this.elem.appendChild(this.currentValueElem);this.elem.appendChild(this.dropdownOptionsElem);document.addEventListener("click",function(t){if(t.target===i.currentValueElem){i.elem.classList.toggle("dropdownOpen");i.dropdownVisible=!i.dropdownVisible}else if(t.target&&t.target.parentNode===i.dropdownOptionsElem){if(typeof t.target.dataset.id!=="undefined"){var e=parseInt(t.target.dataset.id);i.close();if(i.selectedOption!==e){i.selectedOption=e;i.render();i.changeCallback(i.options[i.selectedOption].value)}}}else{i.close()}},true);document.addEventListener("contextmenu",function(){i.close()},true);document.addEventListener("keyup",function(t){if(t.key==="Escape")i.close()},true)}t.prototype.setOptions=function(t,e){this.options=t;var i=0,n=0;for(i=0;i<t.length;i++){if(t[i].value===e){n=i}}this.selectedOption=n;this.render()};t.prototype.render=function(){this.elem.classList.add("loaded");this.currentValueElem.innerHTML=this.options[this.selectedOption].name;var t="",e;for(e=0;e<this.options.length;e++){t+='<div class="dropdownOption'+(this.selectedOption===e?" selected":"")+'" data-id="'+e+'">'+this.options[e].name+"</div>"}t+="";this.dropdownOptionsElem.innerHTML=t;this.dropdownOptionsElem.style.cssText="opacity:0; display:block;";this.currentValueElem.style.width=this.dropdownOptionsElem.offsetWidth+12+"px";this.dropdownOptionsElem.style.cssText="right:0; overflow-y:auto; max-height:294px;"};t.prototype.close=function(){this.elem.classList.remove("dropdownOpen");this.dropdownVisible=false};return t}();"use strict";var expandedCommitHeight=250;var Branch=function(){function t(t){this.vertices=[];this.lines=[];this.colour=t;this.end=0}t.prototype.addVertex=function(t){this.vertices.push(t)};t.prototype.addLine=function(t,e,i){this.lines.push({p1:t,p2:e,isCommitted:i})};t.prototype.addLines=function(t){for(var e=0;e<t.length;e++){this.lines.push(t[e])}};t.prototype.isMergeOnly=function(){return this.vertices.length===2&&this.vertices[0].isMerge()&&!this.vertices[0].isOnThisBranch(this)&&!this.vertices[1].isOnThisBranch(this)};t.prototype.simplifyMergeOnly=function(){var t=this.vertices[0].getLastParent();if(t===null)return;var e=t.getBranch();if(e!==null){e.addLines(this.lines)}};t.prototype.getColour=function(){return this.colour};t.prototype.getEnd=function(){return this.end};t.prototype.setEnd=function(t){this.end=t};t.prototype.draw=function(t,e,i){this.simplifyVerticalLines();var n=e.graphColours[this.colour%e.graphColours.length],o,s,a,r,l;for(o=0;o<this.lines.length;o++){s=this.lines[o].p1.x*e.grid.x+e.grid.offsetX;a=this.lines[o].p1.y*e.grid.y+e.grid.offsetY;r=this.lines[o].p2.x*e.grid.x+e.grid.offsetX;l=this.lines[o].p2.y*e.grid.y+e.grid.offsetY;if(i>-1){if(this.lines[o].p1.y>i){a+=expandedCommitHeight;l+=expandedCommitHeight}else if(this.lines[o].p2.y>i){if(s<r){this.drawLine(t,r,a+e.grid.y,r,l+expandedCommitHeight,this.lines[o].isCommitted?n:"#808080",e)}else if(s>r){this.drawLine(t,s,a,s,l-e.grid.y+expandedCommitHeight,this.lines[o].isCommitted?n:"#808080",e);a+=expandedCommitHeight;l+=expandedCommitHeight}else{l+=expandedCommitHeight}}}this.drawLine(t,s,a,r,l,this.lines[o].isCommitted?n:"#808080",e)}};t.prototype.drawLine=function(t,e,i,n,o,s,a){var r=document.createElementNS("http://www.w3.org/2000/svg","path"),l=document.createElementNS("http://www.w3.org/2000/svg","path"),c;if(e===n){c="M "+e+" "+i+" L "+n+" "+o}else{if(a.graphStyle==="angular"){c="M "+e+" "+i+" L "+(e<n?n+" "+(o-a.grid.y*.38):e+" "+(i+a.grid.y*.38))+" L "+n+" "+o}else{c="M "+e+" "+i+" C "+e+" "+(i+a.grid.y*.8)+" "+n+" "+(o-a.grid.y*.8)+" "+n+" "+o}}r.setAttribute("class","shaddow");r.setAttribute("d",c);t.appendChild(r);l.setAttribute("class","line");l.setAttribute("d",c);l.setAttribute("stroke",s);t.appendChild(l)};t.prototype.simplifyVerticalLines=function(){var t=0;while(t<this.lines.length-1){if(this.lines[t].p1.x===this.lines[t].p2.x&&this.lines[t].p2.x===this.lines[t+1].p1.x&&this.lines[t+1].p1.x===this.lines[t+1].p2.x&&this.lines[t].p2.y===this.lines[t+1].p1.y&&this.lines[t].isCommitted===this.lines[t+1].isCommitted){this.lines[t].p2.y=this.lines[t+1].p2.y;this.lines.splice(t+1,1)}else{t++}}};return t}();var Vertex=function(){function t(t,e,i){this.x=0;this.y=t;this.parents=[];this.nextParent=0;this.onBranch=null;this.isCommitted=e;this.isCurrent=i;this.nextX=0}t.prototype.addParent=function(t){this.parents.push(t)};t.prototype.hasParents=function(){return this.parents.length>0};t.prototype.getNextParent=function(){if(this.nextParent<this.parents.length)return this.parents[this.nextParent];return null};t.prototype.getLastParent=function(){if(this.nextParent<1)return null;return this.parents[this.nextParent-1]};t.prototype.registerParentProcessed=function(){this.nextParent++};t.prototype.isMerge=function(){return this.parents.length>1};t.prototype.addToBranch=function(t,e){t.addVertex(this);if(this.onBranch===null){this.onBranch=t;this.x=e}};t.prototype.isNotOnBranch=function(){return this.onBranch===null};t.prototype.isOnThisBranch=function(t){return this.onBranch===t};t.prototype.getBranch=function(){return this.onBranch};t.prototype.getPoint=function(){return{x:this.x,y:this.y}};t.prototype.getNextPoint=function(){return{x:this.nextX,y:this.y}};t.prototype.getIsCommitted=function(){return this.isCommitted};t.prototype.setNextX=function(t){if(t>this.nextX)this.nextX=t};t.prototype.getColour=function(){return this.onBranch!==null?this.onBranch.getColour():0};t.prototype.draw=function(t,e,i){if(this.onBranch===null)return;var n=document.createElementNS("http://www.w3.org/2000/svg","circle");var o=this.isCommitted?e.graphColours[this.onBranch.getColour()%e.graphColours.length]:"#808080";n.setAttribute("cx",(this.x*e.grid.x+e.grid.offsetX).toString());n.setAttribute("cy",(this.y*e.grid.y+e.grid.offsetY+(i?expandedCommitHeight:0)).toString());n.setAttribute("r","4");if(this.isCurrent){n.setAttribute("class","current");n.setAttribute("stroke",o)}else{n.setAttribute("fill",o)}t.appendChild(n)};return t}();var Graph=function(){function t(t,e){this.vertices=[];this.branches=[];this.availableColours=[];this.elem=document.getElementById(t);this.config=e}t.prototype.loadCommits=function(t,e){this.vertices=[];this.branches=[];this.availableColours=[];var i,n;for(i=0;i<t.length;i++){this.vertices.push(new Vertex(i,t[i].hash!=="*",t[i].current))}for(i=0;i<t.length;i++){for(n=0;n<t[i].parentHashes.length;n++){if(typeof e[t[i].parentHashes[n]]==="number"){this.vertices[i].addParent(this.vertices[e[t[i].parentHashes[n]]])}}}while((i=this.findStart())!==-1){this.determinePath(i)}};t.prototype.render=function(t){var e=document.createElementNS("http://www.w3.org/2000/svg","svg"),i;e.setAttribute("width",this.getWidth().toString());e.setAttribute("height",this.getHeight(t).toString());for(i=0;i<this.branches.length;i++){this.branches[i].draw(e,this.config,t!==null?t.id:-1)}for(i=0;i<this.vertices.length;i++){this.vertices[i].draw(e,this.config,t!==null&&i>t.id)}this.clear();this.elem.appendChild(e)};t.prototype.clear=function(){if(this.elem.firstChild){this.elem.removeChild(this.elem.firstChild)}};t.prototype.getWidth=function(){var t=0,e,i;for(e=0;e<this.vertices.length;e++){i=this.vertices[e].getNextPoint();if(i.x>t)t=i.x}return t*this.config.grid.x};t.prototype.getHeight=function(t){return this.vertices.length*this.config.grid.y+(t!==null?expandedCommitHeight:0)};t.prototype.getVertexColour=function(t){return this.vertices[t].getColour()};t.prototype.determinePath=function(t){var e=t;var i=new Branch(this.getAvailableColour(t));var n=this.vertices[e],o=this.vertices[e].getNextParent();var s=n.isNotOnBranch()?n.getNextPoint():n.getPoint(),a;n.setNextX(s.x+1);n.addToBranch(i,s.x);for(e=t+1;e<this.vertices.length;e++){a=o===this.vertices[e]&&!o.isNotOnBranch()?this.vertices[e].getPoint():this.vertices[e].getNextPoint();i.addLine(s,a,n.getIsCommitted());s=a;this.vertices[e].setNextX(a.x+1);if(o===this.vertices[e]){n.registerParentProcessed();var r=!o.isNotOnBranch();o.addToBranch(i,a.x);n=o;o=n.getNextParent();if(r)break}}i.setEnd(e);if(i.isMergeOnly()){i.simplifyMergeOnly()}else{this.branches.push(i);this.availableColours[i.getColour()]=i.getEnd()}};t.prototype.findStart=function(){for(var t=0;t<this.vertices.length;t++){if(this.vertices[t].getNextParent()!==null||this.vertices[t].isNotOnBranch())return t}return-1};t.prototype.getAvailableColour=function(t){for(var e=0;e<this.availableColours.length;e++){if(t>this.availableColours[e]){return e}}this.availableColours.push(0);return this.availableColours.length-1};return t}();"use strict";(function(){var e=acquireVsCodeApi();var h={alert:'<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M8.893 1.5c-.183-.31-.52-.5-.887-.5s-.703.19-.886.5L.138 13.499a.98.98 0 0 0 0 1.001c.193.31.53.501.886.501h13.964c.367 0 .704-.19.877-.5a1.03 1.03 0 0 0 .01-1.002L8.893 1.5zm.133 11.497H6.987v-2.003h2.039v2.003zm0-3.004H6.987V5.987h2.039v4.006z"/></svg>',branch:'<svg xmlns="http://www.w3.org/2000/svg" width="10" height="16" viewBox="0 0 10 16"><path fill-rule="evenodd" d="M10 5c0-1.11-.89-2-2-2a1.993 1.993 0 0 0-1 3.72v.3c-.02.52-.23.98-.63 1.38-.4.4-.86.61-1.38.63-.83.02-1.48.16-2 .45V4.72a1.993 1.993 0 0 0-1-3.72C.88 1 0 1.89 0 3a2 2 0 0 0 1 1.72v6.56c-.59.35-1 .99-1 1.72 0 1.11.89 2 2 2 1.11 0 2-.89 2-2 0-.53-.2-1-.53-1.36.09-.06.48-.41.59-.47.25-.11.56-.17.94-.17 1.05-.05 1.95-.45 2.75-1.25S8.95 7.77 9 6.73h-.02C9.59 6.37 10 5.73 10 5zM2 1.8c.66 0 1.2.55 1.2 1.2 0 .65-.55 1.2-1.2 1.2C1.35 4.2.8 3.65.8 3c0-.65.55-1.2 1.2-1.2zm0 12.41c-.66 0-1.2-.55-1.2-1.2 0-.65.55-1.2 1.2-1.2.65 0 1.2.55 1.2 1.2 0 .65-.55 1.2-1.2 1.2zm6-8c-.66 0-1.2-.55-1.2-1.2 0-.65.55-1.2 1.2-1.2.65 0 1.2.55 1.2 1.2 0 .65-.55 1.2-1.2 1.2z"/></svg>',close:'<svg xmlns="http://www.w3.org/2000/svg" width="12" height="16" viewBox="0 0 12 16"><path fill-rule="evenodd" d="M7.48 8l3.75 3.75-1.48 1.48L6 9.48l-3.75 3.75-1.48-1.48L4.52 8 .77 4.25l1.48-1.48L6 6.52l3.75-3.75 1.48 1.48L7.48 8z"/></svg>',tag:'<svg xmlns="http://www.w3.org/2000/svg" width="15" height="16" viewBox="0 0 15 16"><path fill-rule="evenodd" d="M7.73 1.73C7.26 1.26 6.62 1 5.96 1H3.5C2.13 1 1 2.13 1 3.5v2.47c0 .66.27 1.3.73 1.77l6.06 6.06c.39.39 1.02.39 1.41 0l4.59-4.59a.996.996 0 0 0 0-1.41L7.73 1.73zM2.38 7.09c-.31-.3-.47-.7-.47-1.13V3.5c0-.88.72-1.59 1.59-1.59h2.47c.42 0 .83.16 1.13.47l6.14 6.13-4.73 4.73-6.13-6.15zM3.01 3h2v2H3V3h.01z"/></svg>',loading:'<svg xmlns="http://www.w3.org/2000/svg" width="24" height="32" viewBox="0 0 12 16"><path fill-rule="evenodd" d="M10.24 7.4a4.15 4.15 0 0 1-1.2 3.6 4.346 4.346 0 0 1-5.41.54L4.8 10.4.5 9.8l.6 4.2 1.31-1.26c2.36 1.74 5.7 1.57 7.84-.54a5.876 5.876 0 0 0 1.74-4.46l-1.75-.34zM2.96 5a4.346 4.346 0 0 1 5.41-.54L7.2 5.6l4.3.6-.6-4.2-1.31 1.26c-2.36-1.74-5.7-1.57-7.85.54C.5 5.03-.06 6.65.01 8.26l1.75.35A4.17 4.17 0 0 1 2.96 5z"/></svg>',openFolder:'<svg xmlns="http://www.w3.org/2000/svg" class="openFolderIcon" viewBox="0 0 30 30"><path d="M 5 4 C 3.895 4 3 4.895 3 6 L 3 9 L 3 11 L 22 11 L 27 11 L 27 8 C 27 6.895 26.105 6 25 6 L 12.199219 6 L 11.582031 4.9707031 C 11.221031 4.3687031 10.570187 4 9.8671875 4 L 5 4 z M 2.5019531 13 C 1.4929531 13 0.77040625 13.977406 1.0664062 14.941406 L 4.0351562 24.587891 C 4.2941563 25.426891 5.0692656 26 5.9472656 26 L 15 26 L 24.052734 26 C 24.930734 26 25.705844 25.426891 25.964844 24.587891 L 28.933594 14.941406 C 29.229594 13.977406 28.507047 13 27.498047 13 L 15 13 L 2.5019531 13 z"/></svg>',closedFolder:'<svg xmlns="http://www.w3.org/2000/svg" class="closedFolderIcon" viewBox="0 0 30 30"><path d="M 4 3 C 2.895 3 2 3.895 2 5 L 2 8 L 13 8 L 28 8 L 28 7 C 28 5.895 27.105 5 26 5 L 11.199219 5 L 10.582031 3.9707031 C 10.221031 3.3687031 9.5701875 3 8.8671875 3 L 4 3 z M 3 10 C 2.448 10 2 10.448 2 11 L 2 23 C 2 24.105 2.895 25 4 25 L 26 25 C 27.105 25 28 24.105 28 23 L 28 11 C 28 10.448 27.552 10 27 10 L 3 10 z"/></svg>',file:'<svg xmlns="http://www.w3.org/2000/svg" class="fileIcon" viewBox="0 0 30 30"><path d="M24.707,8.793l-6.5-6.5C18.019,2.105,17.765,2,17.5,2H7C5.895,2,5,2.895,5,4v22c0,1.105,0.895,2,2,2h16c1.105,0,2-0.895,2-2 V9.5C25,9.235,24.895,8.981,24.707,8.793z M18,10c-0.552,0-1-0.448-1-1V3.904L23.096,10H18z"/></svg>'};var r=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];var i={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","/":"&#x2F;"};var n={"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"',"&#x27;":"'","&#x2F;":"/"};var o=/[&<>"'\/]/g;var s=/&lt;|&gt;|&amp;|&quot;|&#x27;|&#x2F;/g;var u=/^[-\/].*|[\\" ><~^:?*[]|\.\.|\/\/|\/\.|@{|[.\/]$|\.lock$|^@$/g;var m="&#8230;";var t=function(){function t(t,e,i,n){var o=this;this.gitBranches=[];this.gitHead=null;this.commits=[];this.commitLookup={};this.currentBranch=null;this.moreCommitsAvailable=false;this.showRemoteBranches=true;this.expandedCommit=null;this.loadBranchesCallback=null;this.loadCommitsCallback=null;this.gitRepos=t;this.config=i;this.maxCommits=i.initialLoadCommits;this.graph=new Graph("commitGraph",this.config);this.tableElem=document.getElementById("commitTable");this.repoDropdown=new Dropdown("repoSelect",function(t){o.currentRepo=o.gitRepos[parseInt(t)];o.maxCommits=o.config.initialLoadCommits;o.expandedCommit=null;o.currentBranch=null;o.saveState();o.refresh(true)});this.branchDropdown=new Dropdown("branchSelect",function(t){o.currentBranch=t;o.maxCommits=o.config.initialLoadCommits;o.expandedCommit=null;o.saveState();o.renderShowLoading();o.requestLoadCommits(true,function(){})});this.showRemoteBranchesElem=document.getElementById("showRemoteBranchesCheckbox");this.showRemoteBranchesElem.addEventListener("change",function(){o.showRemoteBranches=o.showRemoteBranchesElem.checked;o.saveState();o.refresh(true)});document.getElementById("refreshBtn").addEventListener("click",function(){o.refresh(true)});this.renderShowLoading();if(n){this.currentBranch=n.currentBranch;this.showRemoteBranches=n.showRemoteBranches;this.showRemoteBranchesElem.checked=this.showRemoteBranches;if(this.gitRepos.indexOf(n.currentRepo)>-1){this.currentRepo=n.currentRepo;this.maxCommits=n.maxCommits;this.expandedCommit=n.expandedCommit;if(n.commits.length>0)this.loadCommits(n.commits,n.moreCommitsAvailable,true);if(n.gitBranches.length>0||n.gitHead!==null)this.loadBranches(n.gitBranches,n.gitHead,true)}}this.loadRepos(this.gitRepos,e);this.requestLoadBranchesAndCommits(false)}t.prototype.loadRepos=function(t,e){this.gitRepos=t;this.saveState();var i=this.gitRepos.indexOf(this.currentRepo),n=false;if(i===-1){this.currentRepo=e!==null&&this.gitRepos.indexOf(e)>-1?e:this.gitRepos[0];i=this.gitRepos.indexOf(this.currentRepo);this.saveState();n=true}var o=[],s,a;for(a=0;a<this.gitRepos.length;a++){s=this.gitRepos[a].split("/");o.push({name:s[s.length-1],value:a.toString()})}document.getElementById("repoControl").style.display=this.gitRepos.length>1?"inline":"none";this.repoDropdown.setOptions(o,i.toString());if(n){this.refresh(true)}};t.prototype.loadBranches=function(t,e,i){if(!i&&k(this.gitBranches,t,function(t,e){return t===e})&&this.gitHead===e){this.triggerLoadBranchesCallback(false);return}this.gitBranches=t;this.gitHead=e;if(this.currentBranch===null||this.currentBranch!==""&&this.gitBranches.indexOf(this.currentBranch)===-1){this.currentBranch=this.config.showCurrentBranchByDefault&&this.gitHead!==null?this.gitHead:""}this.saveState();var n=[{name:"Show All",value:""}];for(var o=0;o<this.gitBranches.length;o++){n.push({name:this.gitBranches[o].indexOf("remotes/")===0?this.gitBranches[o].substring(8):this.gitBranches[o],value:this.gitBranches[o]})}this.branchDropdown.setOptions(n,this.currentBranch);this.triggerLoadBranchesCallback(true)};t.prototype.triggerLoadBranchesCallback=function(t){if(this.loadBranchesCallback!==null){this.loadBranchesCallback(t);this.loadBranchesCallback=null}};t.prototype.loadCommits=function(t,e,i){if(!i&&this.moreCommitsAvailable===e&&k(this.commits,t,function(t,e){return t.hash===e.hash&&t.current===e.current&&k(t.refs,e.refs,function(t,e){return t.name===e.name&&t.type===e.type})&&k(t.parentHashes,e.parentHashes,function(t,e){return t===e})})){if(this.commits.length>0&&this.commits[0].hash==="*"){this.commits[0]=t[0];this.saveState();this.renderUncommitedChanges()}this.triggerLoadCommitsCallback(false);return}this.moreCommitsAvailable=e;this.commits=t;this.commitLookup={};this.saveState();var n,o=false;for(n=0;n<this.commits.length;n++){this.commitLookup[this.commits[n].hash]=n;if(this.expandedCommit!==null&&this.expandedCommit.hash===this.commits[n].hash)o=true}this.graph.loadCommits(this.commits,this.commitLookup);if(this.expandedCommit!==null&&!o){this.expandedCommit=null;this.saveState()}this.render();this.triggerLoadCommitsCallback(true)};t.prototype.triggerLoadCommitsCallback=function(t){if(this.loadCommitsCallback!==null){this.loadCommitsCallback(t);this.loadCommitsCallback=null}};t.prototype.refresh=function(t){if(t){if(this.expandedCommit!==null){this.expandedCommit=null;this.saveState()}this.renderShowLoading()}this.requestLoadBranchesAndCommits(t)};t.prototype.requestLoadBranches=function(t,e){if(this.loadBranchesCallback!==null)return;this.loadBranchesCallback=e;v({command:"loadBranches",repo:this.currentRepo,showRemoteBranches:this.showRemoteBranches,hard:t})};t.prototype.requestLoadCommits=function(t,e){if(this.loadCommitsCallback!==null)return;this.loadCommitsCallback=e;v({command:"loadCommits",repo:this.currentRepo,branchName:this.currentBranch!==null?this.currentBranch:"",maxCommits:this.maxCommits,showRemoteBranches:this.showRemoteBranches,hard:t})};t.prototype.requestLoadBranchesAndCommits=function(i){var t=this;this.requestLoadBranches(i,function(e){t.requestLoadCommits(i,function(t){if(!i&&(e||t)){U()}})})};t.prototype.saveState=function(){e.setState({gitRepos:this.gitRepos,gitBranches:this.gitBranches,gitHead:this.gitHead,commits:this.commits,currentBranch:this.currentBranch,currentRepo:this.currentRepo,moreCommitsAvailable:this.moreCommitsAvailable,maxCommits:this.maxCommits,showRemoteBranches:this.showRemoteBranches,expandedCommit:this.expandedCommit})};t.prototype.render=function(){this.renderGraph();this.renderTable()};t.prototype.renderGraph=function(){this.graph.render(this.expandedCommit)};t.prototype.renderTable=function(){var o=this;var t='<tr><th id="tableHeaderGraphCol">Graph</th><th>Description</th><th>Date</th><th>Author</th><th>Commit</th></tr>',e;for(e=0;e<this.commits.length;e++){var i="",n=L(this.commits[e].message),s=C(this.commits[e].date),a=void 0,r=void 0;for(a=0;a<this.commits[e].refs.length;a++){r=L(this.commits[e].refs[a].name);i+='<span class="gitRef '+this.commits[e].refs[a].type+'" data-name="'+r+'">'+(this.commits[e].refs[a].type==="tag"?h.tag:h.branch).replace("viewBox",'class="colour'+this.graph.getVertexColour(e)+'" viewBox')+r+"</span>"}t+="<tr "+(this.commits[e].hash!=="*"?'class="commit" data-hash="'+this.commits[e].hash+'"':'class="unsavedChanges"')+' data-id="'+e+'"><td></td><td>'+i+(this.commits[e].hash!=="*"?n:"<b>"+n+"</b>")+'</td><td title="'+s.title+'">'+s.value+'</td><td title="'+L(this.commits[e].author+" <"+this.commits[e].email+">")+'">'+L(this.commits[e].author)+'</td><td title="'+L(this.commits[e].hash)+'">'+B(this.commits[e].hash)+"</td></tr>"}if(this.moreCommitsAvailable){t+='<tr><td colspan="5"><div id="loadMoreCommitsBtn" class="roundedBtn">Load More Commits</div></td></tr>'}this.tableElem.innerHTML="<table>"+t+"</table>";document.getElementById("tableHeaderGraphCol").style.padding="0 "+Math.round((Math.max(this.graph.getWidth()+16,64)-(document.getElementById("tableHeaderGraphCol").offsetWidth-24))/2)+"px";if(this.moreCommitsAvailable){document.getElementById("loadMoreCommitsBtn").addEventListener("click",function(){document.getElementById("loadMoreCommitsBtn").parentNode.innerHTML='<h2 id="loadingHeader">'+h.loading+"Loading ...</h2>";o.maxCommits+=o.config.loadMoreCommits;o.hideCommitDetails();o.saveState();o.requestLoadCommits(true,function(){})})}if(this.expandedCommit!==null){var l=null,c=document.getElementsByClassName("commit");for(e=0;e<c.length;e++){if(this.expandedCommit.hash===c[e].dataset.hash){l=c[e];break}}if(l===null){this.expandedCommit=null;this.saveState()}else{this.expandedCommit.id=parseInt(l.dataset.id);this.expandedCommit.srcElem=l;this.saveState();if(this.expandedCommit.commitDetails!==null&&this.expandedCommit.fileTree!==null){this.showCommitDetails(this.expandedCommit.commitDetails,this.expandedCommit.fileTree)}else{this.loadCommitDetails(l)}}}E("commit","contextmenu",function(t){t.stopPropagation();var e=t.target.closest(".commit");var i=e.dataset.hash;D(t,[{title:"Add Tag"+m,onClick:function(){N("Add tag to commit <b><i>"+B(i)+"</i></b>:",[{type:"text-ref",name:"Name: ",default:""},{type:"select",name:"Type: ",default:"annotated",options:[{name:"Annotated",value:"annotated"},{name:"Lightweight",value:"lightweight"}]},{type:"text",name:"Message: ",default:"",placeholder:"Optional"}],"Add Tag",function(t){v({command:"addTag",repo:o.currentRepo,tagName:t[0],commitHash:i,lightweight:t[1]==="lightweight",message:t[2]})},e)}},{title:"Create Branch"+m,onClick:function(){S("Enter the name of the branch you would like to create from commit <b><i>"+B(i)+"</i></b>:","","Create Branch",function(t){v({command:"createBranch",repo:o.currentRepo,branchName:t,commitHash:i})},e)}},null,{title:"Checkout"+m,onClick:function(){M("Are you sure you want to checkout commit <b><i>"+B(i)+"</i></b>? This will result in a 'detached HEAD' state.",function(){v({command:"checkoutCommit",repo:o.currentRepo,commitHash:i})},e)}},{title:"Cherry Pick"+m,onClick:function(){if(o.commits[o.commitLookup[i]].parentHashes.length===1){M("Are you sure you want to cherry pick commit <b><i>"+B(i)+"</i></b>?",function(){v({command:"cherrypickCommit",repo:o.currentRepo,commitHash:i,parentIndex:0})},e)}else{var t=o.commits[o.commitLookup[i]].parentHashes.map(function(t,e){return{name:B(t)+(typeof o.commitLookup[t]==="number"?": "+o.commits[o.commitLookup[t]].message:""),value:(e+1).toString()}});T("Are you sure you want to cherry pick merge commit <b><i>"+B(i)+"</i></b>? Choose the parent hash on the main branch, to cherry pick the commit relative to:","1",t,"Yes, cherry pick commit",function(t){v({command:"cherrypickCommit",repo:o.currentRepo,commitHash:i,parentIndex:parseInt(t)})},e)}}},{title:"Revert"+m,onClick:function(){if(o.commits[o.commitLookup[i]].parentHashes.length===1){M("Are you sure you want to revert commit <b><i>"+B(i)+"</i></b>?",function(){v({command:"revertCommit",repo:o.currentRepo,commitHash:i,parentIndex:0})},e)}else{var t=o.commits[o.commitLookup[i]].parentHashes.map(function(t,e){return{name:B(t)+(typeof o.commitLookup[t]==="number"?": "+o.commits[o.commitLookup[t]].message:""),value:(e+1).toString()}});T("Are you sure you want to revert merge commit <b><i>"+B(i)+"</i></b>? Choose the parent hash on the main branch, to revert the commit relative to:","1",t,"Yes, revert commit",function(t){v({command:"revertCommit",repo:o.currentRepo,commitHash:i,parentIndex:parseInt(t)})},e)}}},null,{title:"Merge into current branch"+m,onClick:function(){I("Are you sure you want to merge commit <b><i>"+B(i)+"</i></b> into the current branch?","Create a new commit even if fast-forward is possible",true,"Yes, merge",function(t){v({command:"mergeCommit",repo:o.currentRepo,commitHash:i,createNewCommit:t})},null)}},{title:"Reset current branch to this Commit"+m,onClick:function(){T("Are you sure you want to reset the <b>current branch</b> to commit <b><i>"+B(i)+"</i></b>?","mixed",[{name:"Soft - Keep all changes, but reset head",value:"soft"},{name:"Mixed - Keep working tree, but reset index",value:"mixed"},{name:"Hard - Discard all changes",value:"hard"}],"Yes, reset",function(t){v({command:"resetToCommit",repo:o.currentRepo,commitHash:i,resetMode:t})},e)}},null,{title:"Copy Commit Hash to Clipboard",onClick:function(){v({command:"copyCommitHashToClipboard",repo:o.currentRepo,commitHash:i})}}],e)});E("commit","click",function(t){var e=t.target.closest(".commit");if(o.expandedCommit!==null&&o.expandedCommit.hash===e.dataset.hash){o.hideCommitDetails()}else{o.loadCommitDetails(e)}});E("gitRef","contextmenu",function(t){t.stopPropagation();var e=t.target.closest(".gitRef");var i=R(e.dataset.name),n;if(e.classList.contains("tag")){n=[{title:"Delete Tag"+m,onClick:function(){M("Are you sure you want to delete the tag <b><i>"+L(i)+"</i></b>?",function(){v({command:"deleteTag",repo:o.currentRepo,tagName:i})},null)}},{title:"Push Tag"+m,onClick:function(){M("Are you sure you want to push the tag <b><i>"+L(i)+"</i></b>?",function(){v({command:"pushTag",repo:o.currentRepo,tagName:i});O("Pushing Tag")},null)}}]}else{if(e.classList.contains("head")){n=[{title:"Checkout Branch",onClick:function(){return o.checkoutBranchAction(e,i)}},{title:"Rename Branch"+m,onClick:function(){S("Enter the new name for branch <b><i>"+L(i)+"</i></b>:",i,"Rename Branch",function(t){v({command:"renameBranch",repo:o.currentRepo,oldName:i,newName:t})},null)}},{title:"Delete Branch"+m,onClick:function(){I("Are you sure you want to delete the branch <b><i>"+L(i)+"</i></b>?","Force Delete",false,"Delete Branch",function(t){v({command:"deleteBranch",repo:o.currentRepo,branchName:i,forceDelete:t})},null)}}];if(o.gitHead!==i){n.push({title:"Merge into current branch"+m,onClick:function(){I("Are you sure you want to merge branch <b><i>"+L(i)+"</i></b> into the current branch?","Create a new commit even if fast-forward is possible",true,"Yes, merge",function(t){v({command:"mergeBranch",repo:o.currentRepo,branchName:i,createNewCommit:t})},null)}})}}else{n=[{title:"Checkout Branch"+m,onClick:function(){return o.checkoutBranchAction(e,i)}}]}}D(t,n,e)});E("gitRef","click",function(t){return t.stopPropagation()});E("gitRef","dblclick",function(t){t.stopPropagation();U();var e=t.target.closest(".gitRef");o.checkoutBranchAction(e,R(e.dataset.name))})};t.prototype.renderUncommitedChanges=function(){var t=C(this.commits[0].date);document.getElementsByClassName("unsavedChanges")[0].innerHTML="<td></td><td><b>"+L(this.commits[0].message)+'</b></td><td title="'+t.title+'">'+t.value+'</td><td title="* <>">*</td><td title="*">*</td>'};t.prototype.renderShowLoading=function(){U();this.graph.clear();this.tableElem.innerHTML='<table><tr><th id="tableHeaderGraphCol">Graph</th><th>Description</th><th>Date</th><th>Author</th><th>Commit</th></tr></table><h2 id="loadingHeader">'+h.loading+"Loading ...</h2>"};t.prototype.checkoutBranchAction=function(t,e){var i=this;if(t.classList.contains("head")){v({command:"checkoutBranch",repo:this.currentRepo,branchName:e,remoteBranch:null})}else if(t.classList.contains("remote")){var n=e.split("/");S("Enter the name of the new branch you would like to create when checking out <b><i>"+L(t.dataset.name)+"</i></b>:",n[n.length-1],"Checkout Branch",function(t){v({command:"checkoutBranch",repo:i.currentRepo,branchName:t,remoteBranch:e})},null)}};t.prototype.loadCommitDetails=function(t){this.hideCommitDetails();this.expandedCommit={id:parseInt(t.dataset.id),hash:t.dataset.hash,srcElem:t,commitDetails:null,fileTree:null};this.saveState();v({command:"commitDetails",repo:this.currentRepo,commitHash:t.dataset.hash})};t.prototype.hideCommitDetails=function(){if(this.expandedCommit!==null){var t=document.getElementById("commitDetails");if(typeof t==="object"&&t!==null)t.remove();if(typeof this.expandedCommit.srcElem==="object"&&this.expandedCommit.srcElem!==null)this.expandedCommit.srcElem.classList.remove("commitDetailsOpen");this.expandedCommit=null;this.saveState();this.renderGraph()}};t.prototype.showCommitDetails=function(t,e){var o=this;if(this.expandedCommit===null||this.expandedCommit.srcElem===null||this.expandedCommit.hash!==t.hash)return;var i=document.getElementById("commitDetails");if(typeof i==="object"&&i!==null)i.remove();this.expandedCommit.commitDetails=t;this.expandedCommit.fileTree=e;this.expandedCommit.srcElem.classList.add("commitDetailsOpen");this.saveState();var n=document.createElement("tr"),s='<td></td><td colspan="4"><div id="commitDetailsSummary">';s+="<b>Commit: </b>"+L(t.hash)+"<br>";s+="<b>Parents: </b>"+t.parents.join(", ")+"<br>";s+="<b>Author: </b>"+L(t.author)+' &lt;<a href="mailto:'+encodeURIComponent(t.email)+'">'+L(t.email)+"</a>&gt;<br>";s+="<b>Date: </b>"+new Date(t.date*1e3).toString()+"<br>";s+="<b>Committer: </b>"+L(t.committer)+"<br><br>";s+=L(t.body).replace(/\n/g,"<br>")+"</div>";s+='<div id="commitDetailsFiles">'+w(e,t.fileChanges)+"</table></div>";s+='<div id="commitDetailsClose">'+h.close+"</div>";s+="</td>";n.id="commitDetails";n.innerHTML=s;this.renderGraph();H(n,this.expandedCommit.srcElem);if(this.config.autoCenterCommitDetailsView){window.scrollTo(0,n.offsetTop+177-window.innerHeight/2)}else if(n.offsetTop+8<window.pageYOffset){window.scrollTo(0,n.offsetTop+8)}else if(n.offsetTop+expandedCommitHeight-window.innerHeight+48>window.pageYOffset){window.scrollTo(0,n.offsetTop+expandedCommitHeight-window.innerHeight+48)}document.getElementById("commitDetailsClose").addEventListener("click",function(){o.hideCommitDetails()});E("gitFolder","click",function(t){var e=t.target.closest(".gitFolder");var i=e.parentElement;i.classList.toggle("closed");var n=!i.classList.contains("closed");i.children[0].children[0].innerHTML=n?h.openFolder:h.closedFolder;i.children[1].classList.toggle("hidden");x(o.expandedCommit.fileTree,decodeURIComponent(e.dataset.folderpath),n);o.saveState()});E("gitFile","click",function(t){var e=t.target.closest(".gitFile");if(o.expandedCommit===null||!e.classList.contains("gitDiffPossible"))return;v({command:"viewDiff",repo:o.currentRepo,commitHash:o.expandedCommit.hash,oldFilePath:decodeURIComponent(e.dataset.oldfilepath),newFilePath:decodeURIComponent(e.dataset.newfilepath),type:e.dataset.type})})};return t}();var l=document.getElementById("contextMenu"),c=null;var p=document.getElementById("dialog"),a=document.getElementById("dialogBacking"),d=null;var f=new t(viewState.repos,viewState.lastActiveRepo,{autoCenterCommitDetailsView:viewState.autoCenterCommitDetailsView,graphColours:viewState.graphColours,graphStyle:viewState.graphStyle,grid:{x:16,y:24,offsetX:8,offsetY:12},initialLoadCommits:viewState.initialLoadCommits,loadMoreCommits:viewState.loadMoreCommits,showCurrentBranchByDefault:viewState.showCurrentBranchByDefault},e.getState());window.addEventListener("message",function(t){var e=t.data;switch(e.command){case"addTag":g(e.status,"Unable to Add Tag");break;case"checkoutBranch":g(e.status,"Unable to Checkout Branch");break;case"checkoutCommit":g(e.status,"Unable to Checkout Commit");break;case"cherrypickCommit":g(e.status,"Unable to Cherry Pick Commit");break;case"commitDetails":if(e.commitDetails===null){f.hideCommitDetails();P("Unable to load commit details",null,null)}else{f.showCommitDetails(e.commitDetails,y(e.commitDetails.fileChanges))}break;case"copyCommitHashToClipboard":if(e.success===false)P("Unable to Copy Commit Hash to Clipboard",null,null);break;case"createBranch":g(e.status,"Unable to Create Branch");break;case"deleteBranch":g(e.status,"Unable to Delete Branch");break;case"deleteTag":g(e.status,"Unable to Delete Tag");break;case"loadBranches":f.loadBranches(e.branches,e.head,e.hard);break;case"loadCommits":f.loadCommits(e.commits,e.moreCommitsAvailable,e.hard);break;case"loadRepos":f.loadRepos(e.repos,e.lastActiveRepo);break;case"mergeBranch":g(e.status,"Unable to Merge Branch");break;case"mergeCommit":g(e.status,"Unable to Merge Commit");break;case"pushTag":g(e.status,"Unable to Push Tag");break;case"renameBranch":g(e.status,"Unable to Rename Branch");break;case"refresh":f.refresh(false);break;case"resetToCommit":g(e.status,"Unable to Reset to Commit");break;case"revertCommit":g(e.status,"Unable to Revert Commit");break;case"viewDiff":if(e.success===false)P("Unable to view diff of file",null,null);break}});function g(t,e){if(t===null){f.refresh(true)}else{P(e,t,null)}}function v(t){e.postMessage(t)}function C(t){var e=new Date(t*1e3),i;var n=e.getDate()+" "+r[e.getMonth()]+" "+e.getFullYear();var o=b(e.getHours())+":"+b(e.getMinutes());switch(viewState.dateFormat){case"Date Only":i=n;break;case"Relative":var s=Math.round((new Date).getTime()/1e3)-t,a=void 0;if(s<60){a="second"}else if(s<3600){a="minute";s/=60}else if(s<86400){a="hour";s/=3600}else if(s<604800){a="day";s/=86400}else if(s<2629800){a="week";s/=604800}else if(s<31557600){a="month";s/=2629800}else{a="year";s/=31557600}s=Math.round(s);i=s+" "+a+(s!==1?"s":"")+" ago";break;default:i=n+" "+o}return{title:n+" "+o,value:i}}function b(t){return t>9?t:"0"+t}function y(t){var e={},i,n,o,s;var a={type:"folder",name:"",folderPath:"",contents:e,open:true};for(i=0;i<t.length;i++){s=a;o=t[i].newFilePath.split("/");for(n=0;n<o.length;n++){if(n<o.length-1){if(typeof s.contents[o[n]]==="undefined"){e={};s.contents[o[n]]={type:"folder",name:o[n],folderPath:o.slice(0,n+1).join("/"),contents:e,open:true}}s=s.contents[o[n]]}else{s.contents[o[n]]={type:"file",name:o[n],index:i}}}}return a}function w(i,t){var e=(i.name!==""?'<span class="gitFolder" data-folderpath="'+encodeURIComponent(i.folderPath)+'"><span class="gitFolderIcon">'+(i.open?h.openFolder:h.closedFolder)+'</span><span class="gitFolderName">'+i.name+"</span></span>":"")+'<ul class="gitFolderContents'+(!i.open?" hidden":"")+'">',n=Object.keys(i.contents),o,s,a;n.sort(function(t,e){return i.contents[t].type==="folder"&&i.contents[e].type==="file"?-1:i.contents[t].type==="file"&&i.contents[e].type==="folder"?1:i.contents[t].name<i.contents[e].name?-1:i.contents[t].name>i.contents[e].name?1:0});for(o=0;o<n.length;o++){if(i.contents[n[o]].type==="folder"){a=i.contents[n[o]];e+="<li"+(!a.open?' class="closed"':"")+">"+w(a,t)+"</li>"}else{s=t[i.contents[n[o]].index];e+='<li class="gitFile '+s.type+(s.additions!==null&&s.deletions!==null?" gitDiffPossible":"")+'" data-oldfilepath="'+encodeURIComponent(s.oldFilePath)+'" data-newfilepath="'+encodeURIComponent(s.newFilePath)+'" data-type="'+s.type+'"'+(s.additions===null||s.deletions===null?' title="This is a binary file, unable to view diff."':"")+'><span class="gitFileIcon">'+h.file+"</span>"+i.contents[n[o]].name+(s.type==="R"?' <span class="gitFileRename" title="'+L(s.oldFilePath+" was renamed to "+s.newFilePath)+'">R</span>':"")+(s.type!=="A"&&s.type!=="D"&&s.additions!==null&&s.deletions!==null?'<span class="gitFileAddDel">(<span class="gitFileAdditions" title="'+s.additions+" addition"+(s.additions!==1?"s":"")+'">+'+s.additions+'</span>|<span class="gitFileDeletions" title="'+s.deletions+" deletion"+(s.deletions!==1?"s":"")+'">-'+s.deletions+"</span>)</span>":"")+"</li>"}}return e+"</ul>"}function x(t,e,i){var n=e.split("/"),o,s=t;for(o=0;o<n.length;o++){if(typeof s.contents[n[o]]!=="undefined"){s=s.contents[n[o]];if(o===n.length-1){s.open=i;return}}else{return}}}function B(t){return t.substring(0,8)}function k(t,e,i){if(t.length!==e.length)return false;for(var n=0;n<t.length;n++){if(!i(t[n],e[n]))return false}return true}function L(t){return t.replace(o,function(t){return i[t]})}function R(t){return t.replace(s,function(t){return n[t]})}function E(t,e,i){var n=document.getElementsByClassName(t),o;for(o=0;o<n.length;o++){n[o].addEventListener(e,i)}}function H(t,e){e.parentNode.insertBefore(t,e.nextSibling)}function D(t,e,i){var n="",o,s=t;for(o=0;o<e.length;o++){n+=e[o]!==null?'<li class="contextMenuItem" data-index="'+o+'">'+e[o].title+"</li>":'<li class="contextMenuDivider"></li>'}z();l.style.opacity="0";l.className="active";l.innerHTML=n;var a=l.getBoundingClientRect();l.style.left=(s.pageX-window.pageXOffset+a.width<window.innerWidth?s.pageX-2:s.pageX-a.width+2)+"px";l.style.top=(s.pageY-window.pageYOffset+a.height<window.innerHeight?s.pageY-2:s.pageY-a.height+2)+"px";l.style.opacity="1";E("contextMenuItem","click",function(t){t.stopPropagation();A();e[parseInt(t.target.dataset.index)].onClick()});c=i;c.classList.add("contextMenuActive")}function A(){l.className="";l.innerHTML="";l.style.left="0px";l.style.top="0px";if(c!==null){c.classList.remove("contextMenuActive");c=null}}function M(t,e,i){F(t,"Yes","No",function(){V();e()},i)}function S(t,e,i,n,o){N(t,[{type:"text-ref",name:"",default:e}],i,function(t){return n(t[0])},o)}function I(t,e,i,n,o,s){N(t,[{type:"checkbox",name:e,value:i}],n,function(t){return o(t[0]==="checked")},s)}function T(t,e,i,n,o,s){N(t,[{type:"select",name:"",options:i,default:e}],n,function(t){return o(t[0])},s)}function N(t,o,n,s,e){var i=-1,a=o.length>1;var r=t+'<br><table class="dialogForm '+(a?"multi":"single")+'">';for(var l=0;l<o.length;l++){var c=o[l];r+="<tr>"+(a?"<td>"+c.name+"</td>":"")+"<td>";if(c.type==="select"){r+='<select id="dialogInput'+l+'">';for(var h=0;h<c.options.length;h++){r+='<option value="'+c.options[h].value+'"'+(c.options[h].value===c.default?" selected":"")+">"+c.options[h].name+"</option>"}r+="</select>"}else if(c.type==="checkbox"){r+='<span class="dialogFormCheckbox"><label><input id="dialogInput'+l+'" type="checkbox"'+(c.value?" checked":"")+"/>"+(a?"":c.name)+"</label></span>"}else{r+='<input id="dialogInput'+l+'" type="text" value="'+c.default+'"'+(c.type==="text"&&c.placeholder!==null?' placeholder="'+c.placeholder+'"':"")+"/>";if(c.type==="text-ref")i=l}r+="</td></tr>"}r+="</table>";F(r,n,"Cancel",function(){if(p.className==="active noInput"||p.className==="active inputInvalid")return;var t=[];for(var e=0;e<o.length;e++){var i=o[e],n=document.getElementById("dialogInput"+e);if(i.type==="select"){t.push(n.value)}else if(i.type==="checkbox"){t.push(n.checked?"checked":"unchecked")}else{t.push(n.value)}}V();s(t)},e);if(i>-1){var m=document.getElementById("dialogInput"+i),d=document.getElementById("dialogAction");if(m.value==="")p.className="active noInput";m.focus();m.addEventListener("keyup",function(){var t=m.value==="",e=m.value.match(u)!==null;var i="active"+(t?" noInput":e?" inputInvalid":"");if(p.className!==i){p.className=i;d.title=e?"Unable to "+n+", one or more invalid characters entered.":""}})}}function P(t,e,i){F(h.alert+"Error: "+t+(e!==null?'<br><span class="errorReason">'+L(e).split("\n").join("<br>")+"</span>":""),null,"Dismiss",null,i)}function O(t){F('<span id="actionRunning">'+h.loading+t+" ...</span>",null,"Dismiss",null,null)}function F(t,e,i,n,o){a.className="active";p.className="active";p.innerHTML=t+"<br>"+(e!==null?'<div id="dialogAction" class="roundedBtn">'+e+"</div>":"")+'<div id="dialogDismiss" class="roundedBtn">'+i+"</div>";if(e!==null&&n!==null)document.getElementById("dialogAction").addEventListener("click",n);document.getElementById("dialogDismiss").addEventListener("click",V);d=o;if(d!==null)d.classList.add("dialogActive")}function V(){a.className="";p.className="";p.innerHTML="";if(d!==null){d.classList.remove("dialogActive");d=null}}function U(){if(p.classList.contains("active"))V();if(l.classList.contains("active"))A()}document.addEventListener("keyup",function(t){if(t.key==="Escape"){U()}});document.addEventListener("click",z);document.addEventListener("contextmenu",z);document.addEventListener("mouseleave",z);function z(){if(l.classList.contains("active"))A()}})();